\hypertarget{tesseract__kinematics_2core_2include_2tesseract__kinematics_2core_2utils_8h_source}{}\doxysection{utils.\+h}
\label{tesseract__kinematics_2core_2include_2tesseract__kinematics_2core_2utils_8h_source}\index{tesseract\_kinematics/core/include/tesseract\_kinematics/core/utils.h@{tesseract\_kinematics/core/include/tesseract\_kinematics/core/utils.h}}
\mbox{\hyperlink{tesseract__kinematics_2core_2include_2tesseract__kinematics_2core_2utils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifndef TESSERACT\_KINEMATICS\_UTILS\_H}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define TESSERACT\_KINEMATICS\_UTILS\_H}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{macros_8h}{tesseract\_common/macros.h}}>}}
\DoxyCodeLine{30 \mbox{\hyperlink{macros_8h_a8cc0e3c6a3382c5c0b19eb9e676fc2db}{TESSERACT\_COMMON\_IGNORE\_WARNINGS\_PUSH}}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <Eigen/Core>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <Eigen/Geometry>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <Eigen/Eigenvalues>}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include <console\_bridge/console.h>}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{graph_8h}{tesseract\_scene\_graph/graph.h}}>}}
\DoxyCodeLine{37 \mbox{\hyperlink{namespaceTESSERACT__COMMON__IGNORE__WARNINGS__POP}{TESSERACT\_COMMON\_IGNORE\_WARNINGS\_POP}}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{forward__kinematics_8h}{tesseract\_kinematics/core/forward\_kinematics.h}}>}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{kinematic__group_8h}{tesseract\_kinematics/core/kinematic\_group.h}}>}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacetesseract__kinematics}{tesseract\_kinematics}}}
\DoxyCodeLine{43 \{}
\DoxyCodeLine{44 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FloatType>}
\DoxyCodeLine{45 \textcolor{keyword}{using }\mbox{\hyperlink{namespacetesseract__kinematics_a59d7ac70f855c7d00848b703e6bcfe9a}{VectorX}} = Eigen::Matrix<FloatType, Eigen::Dynamic, 1>;}
\DoxyCodeLine{46 }
\DoxyCodeLine{55 \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacetesseract__kinematics_a43f562948ca86e1cd531b12a92191334}{numericalJacobian}}(Eigen::Ref<Eigen::MatrixXd> \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}},}
\DoxyCodeLine{56                                      \textcolor{keyword}{const} Eigen::Isometry3d\& change\_base,}
\DoxyCodeLine{57                                      \textcolor{keyword}{const} \mbox{\hyperlink{classtesseract__kinematics_1_1ForwardKinematics}{tesseract\_kinematics::ForwardKinematics}}\& \mbox{\hyperlink{kinematics__factory__unit_8cpp_a898342b32b9a46004fe36efea9777fc6}{kin}},}
\DoxyCodeLine{58                                      \textcolor{keyword}{const} Eigen::Ref<const Eigen::VectorXd>\& joint\_values,}
\DoxyCodeLine{59                                      \textcolor{keyword}{const} std::string\& link\_name,}
\DoxyCodeLine{60                                      \textcolor{keyword}{const} Eigen::Ref<const Eigen::Vector3d>\& link\_point)}
\DoxyCodeLine{61 \{}
\DoxyCodeLine{62   Eigen::VectorXd njvals;}
\DoxyCodeLine{63   \textcolor{keywordtype}{double} delta = 1e-\/8;}
\DoxyCodeLine{64   \mbox{\hyperlink{namespacetesseract__common_a67bde3cb7bb235f0f61c370ef8bc74d8}{tesseract\_common::TransformMap}} poses = \mbox{\hyperlink{kinematics__factory__unit_8cpp_a898342b32b9a46004fe36efea9777fc6}{kin}}.calcFwdKin(joint\_values);}
\DoxyCodeLine{65   Eigen::Isometry3d \mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}}\{ change\_base * poses[link\_name] \};}
\DoxyCodeLine{66 }
\DoxyCodeLine{67   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < static\_cast<int>(joint\_values.size()); ++i)}
\DoxyCodeLine{68   \{}
\DoxyCodeLine{69     njvals = joint\_values;}
\DoxyCodeLine{70     njvals[i] += delta;}
\DoxyCodeLine{71     Eigen::Isometry3d updated\_pose = \mbox{\hyperlink{kinematics__factory__unit_8cpp_a898342b32b9a46004fe36efea9777fc6}{kin}}.calcFwdKin(njvals)[link\_name];}
\DoxyCodeLine{72     updated\_pose = change\_base * updated\_pose;}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     Eigen::Vector3d temp\{ \mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}} * link\_point \};}
\DoxyCodeLine{75     Eigen::Vector3d temp2\{ updated\_pose * link\_point \};}
\DoxyCodeLine{76     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(0, i) = (temp2.x() -\/ temp.x()) / delta;}
\DoxyCodeLine{77     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(1, i) = (temp2.y() -\/ temp.y()) / delta;}
\DoxyCodeLine{78     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(2, i) = (temp2.z() -\/ temp.z()) / delta;}
\DoxyCodeLine{79 }
\DoxyCodeLine{80     Eigen::Vector3d omega = (\mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}}.rotation() * \mbox{\hyperlink{namespacetesseract__common_a715e8a56239e73ccfa00e82cda79a28c}{tesseract\_common::calcRotationalError}}(\mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}}.rotation().transpose() *}
\DoxyCodeLine{81                                                                                      updated\_pose.rotation())) /}
\DoxyCodeLine{82                             delta;}
\DoxyCodeLine{83     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(3, i) = omega(0);}
\DoxyCodeLine{84     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(4, i) = omega(1);}
\DoxyCodeLine{85     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(5, i) = omega(2);}
\DoxyCodeLine{86   \}}
\DoxyCodeLine{87 \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{97 \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacetesseract__kinematics_a43f562948ca86e1cd531b12a92191334}{numericalJacobian}}(Eigen::Ref<Eigen::MatrixXd> \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}},}
\DoxyCodeLine{98                                      \textcolor{keyword}{const} \mbox{\hyperlink{classtesseract__kinematics_1_1JointGroup}{JointGroup}}\& \mbox{\hyperlink{tesseract__srdf__unit_8cpp_a31d9151d1cb842cded108072204f4194}{joint\_group}},}
\DoxyCodeLine{99                                      \textcolor{keyword}{const} Eigen::Ref<const Eigen::VectorXd>\& joint\_values,}
\DoxyCodeLine{100                                      \textcolor{keyword}{const} std::string\& link\_name,}
\DoxyCodeLine{101                                      \textcolor{keyword}{const} Eigen::Ref<const Eigen::Vector3d>\& link\_point)}
\DoxyCodeLine{102 \{}
\DoxyCodeLine{103   Eigen::VectorXd njvals;}
\DoxyCodeLine{104   \textcolor{keywordtype}{double} delta = 1e-\/8;}
\DoxyCodeLine{105   \mbox{\hyperlink{namespacetesseract__common_a67bde3cb7bb235f0f61c370ef8bc74d8}{tesseract\_common::TransformMap}} poses = \mbox{\hyperlink{tesseract__srdf__unit_8cpp_a31d9151d1cb842cded108072204f4194}{joint\_group}}.\mbox{\hyperlink{classtesseract__kinematics_1_1JointGroup_a3579bdbb9feec4ab90101c6c5a729fa2}{calcFwdKin}}(joint\_values);}
\DoxyCodeLine{106   Eigen::Isometry3d \mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}} = poses[link\_name];}
\DoxyCodeLine{107 }
\DoxyCodeLine{108   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < static\_cast<int>(joint\_values.size()); ++i)}
\DoxyCodeLine{109   \{}
\DoxyCodeLine{110     njvals = joint\_values;}
\DoxyCodeLine{111     njvals[i] += delta;}
\DoxyCodeLine{112     \mbox{\hyperlink{namespacetesseract__common_a67bde3cb7bb235f0f61c370ef8bc74d8}{tesseract\_common::TransformMap}} updated\_poses = \mbox{\hyperlink{tesseract__srdf__unit_8cpp_a31d9151d1cb842cded108072204f4194}{joint\_group}}.\mbox{\hyperlink{classtesseract__kinematics_1_1JointGroup_a3579bdbb9feec4ab90101c6c5a729fa2}{calcFwdKin}}(njvals);}
\DoxyCodeLine{113     Eigen::Isometry3d updated\_pose = updated\_poses[link\_name];}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     Eigen::Vector3d temp = \mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}} * link\_point;}
\DoxyCodeLine{116     Eigen::Vector3d temp2 = updated\_pose * link\_point;}
\DoxyCodeLine{117     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(0, i) = (temp2.x() -\/ temp.x()) / delta;}
\DoxyCodeLine{118     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(1, i) = (temp2.y() -\/ temp.y()) / delta;}
\DoxyCodeLine{119     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(2, i) = (temp2.z() -\/ temp.z()) / delta;}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     Eigen::VectorXd omega = (\mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}}.rotation() * \mbox{\hyperlink{namespacetesseract__common_a715e8a56239e73ccfa00e82cda79a28c}{tesseract\_common::calcRotationalError}}(\mbox{\hyperlink{tesseract__environment__collision_8cpp_a7272862bfe9e301a87918b3d560aebc3}{pose}}.rotation().transpose() *}
\DoxyCodeLine{122                                                                                      updated\_pose.rotation())) /}
\DoxyCodeLine{123                             delta;}
\DoxyCodeLine{124     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(3, i) = omega(0);}
\DoxyCodeLine{125     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(4, i) = omega(1);}
\DoxyCodeLine{126     \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}(5, i) = omega(2);}
\DoxyCodeLine{127   \}}
\DoxyCodeLine{128 \}}
\DoxyCodeLine{129 }
\DoxyCodeLine{138 \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacetesseract__kinematics_a7c0f58b6ad5f6ccb2f3887684f3760f0}{solvePInv}}(\textcolor{keyword}{const} Eigen::Ref<const Eigen::MatrixXd>\& A,}
\DoxyCodeLine{139                              \textcolor{keyword}{const} Eigen::Ref<const Eigen::VectorXd>\& b,}
\DoxyCodeLine{140                              Eigen::Ref<Eigen::VectorXd> x)}
\DoxyCodeLine{141 \{}
\DoxyCodeLine{142   \textcolor{keyword}{const} \textcolor{keywordtype}{double} eps = 0.00001;  \textcolor{comment}{// TODO: Turn into class member var}}
\DoxyCodeLine{143   \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambda = 0.01;  \textcolor{comment}{// TODO: Turn into class member var}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145   \textcolor{keywordflow}{if} ((A.rows() == 0) || (A.cols() == 0))}
\DoxyCodeLine{146   \{}
\DoxyCodeLine{147     CONSOLE\_BRIDGE\_logError(\textcolor{stringliteral}{"{}Empty matrices not supported in solvePinv()"{}});}
\DoxyCodeLine{148     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{149   \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151   \textcolor{keywordflow}{if} (A.rows() != b.size())}
\DoxyCodeLine{152   \{}
\DoxyCodeLine{153     CONSOLE\_BRIDGE\_logError(\textcolor{stringliteral}{"{}Matrix size mismatch: A(\%d, \%d), b(\%d)"{}}, A.rows(), A.cols(), b.size());}
\DoxyCodeLine{154     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{155   \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157   \textcolor{comment}{// Calculate A+ (pseudoinverse of A) = V S+ U*, where U* is Hermition of U (just transpose if all values of U are}}
\DoxyCodeLine{158   \textcolor{comment}{// real)}}
\DoxyCodeLine{159   \textcolor{comment}{// in order to solve Ax=b -\/> x*=A+ b}}
\DoxyCodeLine{160   Eigen::JacobiSVD<Eigen::MatrixXd> svd(A, Eigen::ComputeThinU | Eigen::ComputeThinV);}
\DoxyCodeLine{161   \textcolor{keyword}{const} Eigen::MatrixXd\& U = svd.matrixU();}
\DoxyCodeLine{162   \textcolor{keyword}{const} Eigen::VectorXd\& Sv = svd.singularValues();}
\DoxyCodeLine{163   \textcolor{keyword}{const} Eigen::MatrixXd\& V = svd.matrixV();}
\DoxyCodeLine{164 }
\DoxyCodeLine{165   \textcolor{comment}{// calculate the reciprocal of Singular-\/Values}}
\DoxyCodeLine{166   \textcolor{comment}{// damp inverse with lambda so that inverse doesn't oscillate near solution}}
\DoxyCodeLine{167   \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} nSv = Sv.size();}
\DoxyCodeLine{168   Eigen::VectorXd inv\_Sv(nSv);}
\DoxyCodeLine{169   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{int} i = 0; i < nSv; ++i)}
\DoxyCodeLine{170   \{}
\DoxyCodeLine{171     \textcolor{keywordflow}{if} (fabs(Sv(i)) > eps)}
\DoxyCodeLine{172       inv\_Sv(i) = 1 / Sv(i);}
\DoxyCodeLine{173     \textcolor{keywordflow}{else}}
\DoxyCodeLine{174       inv\_Sv(i) = Sv(i) / (Sv(i) * Sv(i) + lambda * lambda);}
\DoxyCodeLine{175   \}}
\DoxyCodeLine{176   x = V * inv\_Sv.asDiagonal() * U.transpose() * b;}
\DoxyCodeLine{177   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{178 \}}
\DoxyCodeLine{179 }
\DoxyCodeLine{189 \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacetesseract__kinematics_a1645b1b27fd8279b5f0289dfd1f662c7}{dampedPInv}}(\textcolor{keyword}{const} Eigen::Ref<const Eigen::MatrixXd>\& A,}
\DoxyCodeLine{190                               Eigen::Ref<Eigen::MatrixXd> P,}
\DoxyCodeLine{191                               \textcolor{keyword}{const} \textcolor{keywordtype}{double} eps = 0.011,}
\DoxyCodeLine{192                               \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambda = 0.01)}
\DoxyCodeLine{193 \{}
\DoxyCodeLine{194   \textcolor{keywordflow}{if} ((A.rows() == 0) || (A.cols() == 0))}
\DoxyCodeLine{195   \{}
\DoxyCodeLine{196     CONSOLE\_BRIDGE\_logError(\textcolor{stringliteral}{"{}Empty matrices not supported in dampedPInv()"{}});}
\DoxyCodeLine{197     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{198   \}}
\DoxyCodeLine{199 }
\DoxyCodeLine{200   \textcolor{comment}{// Calculate A+ (pseudoinverse of A) = V S+ U*, where U* is Hermition of U (just transpose if all values of U are}}
\DoxyCodeLine{201   \textcolor{comment}{// real)}}
\DoxyCodeLine{202   \textcolor{comment}{// in order to solve Ax=b -\/> x*=A+ b}}
\DoxyCodeLine{203   Eigen::JacobiSVD<Eigen::MatrixXd> svd(A, Eigen::ComputeThinU | Eigen::ComputeThinV);}
\DoxyCodeLine{204   \textcolor{keyword}{const} Eigen::MatrixXd\& U = svd.matrixU();}
\DoxyCodeLine{205   \textcolor{keyword}{const} Eigen::VectorXd\& Sv = svd.singularValues();}
\DoxyCodeLine{206   \textcolor{keyword}{const} Eigen::MatrixXd\& V = svd.matrixV();}
\DoxyCodeLine{207 }
\DoxyCodeLine{208   \textcolor{comment}{// calculate the reciprocal of Singular-\/Values}}
\DoxyCodeLine{209   \textcolor{comment}{// damp inverse with lambda so that inverse doesn't oscillate near solution}}
\DoxyCodeLine{210   \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} nSv = Sv.size();}
\DoxyCodeLine{211   Eigen::VectorXd inv\_Sv(nSv);}
\DoxyCodeLine{212   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{int} i = 0; i < nSv; ++i)}
\DoxyCodeLine{213   \{}
\DoxyCodeLine{214     \textcolor{keywordflow}{if} (fabs(Sv(i)) > eps)}
\DoxyCodeLine{215       inv\_Sv(i) = 1 / Sv(i);}
\DoxyCodeLine{216     \textcolor{keywordflow}{else}}
\DoxyCodeLine{217     \{}
\DoxyCodeLine{218       inv\_Sv(i) = Sv(i) / (Sv(i) * Sv(i) + lambda * lambda);}
\DoxyCodeLine{219     \}}
\DoxyCodeLine{220   \}}
\DoxyCodeLine{221   P = V * inv\_Sv.asDiagonal() * U.transpose();}
\DoxyCodeLine{222   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{223 \}}
\DoxyCodeLine{224 }
\DoxyCodeLine{233 \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacetesseract__kinematics_ae2bebd951f959b4c39b06dc7b38c8159}{isNearSingularity}}(\textcolor{keyword}{const} Eigen::Ref<const Eigen::MatrixXd>\& \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}, \textcolor{keywordtype}{double} threshold = 0.01)}
\DoxyCodeLine{234 \{}
\DoxyCodeLine{235   Eigen::JacobiSVD<Eigen::MatrixXd> svd(\mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}, Eigen::ComputeThinU | Eigen::ComputeThinV);}
\DoxyCodeLine{236   \textcolor{keyword}{const} Eigen::VectorXd\& sv = svd.singularValues();}
\DoxyCodeLine{237   \textcolor{keywordflow}{return} (sv.tail(1).value() < threshold);}
\DoxyCodeLine{238 \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{241 \textcolor{keyword}{struct }\mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}}}
\DoxyCodeLine{242 \{}
\DoxyCodeLine{243   \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{244   EIGEN\_MAKE\_ALIGNED\_OPERATOR\_NEW}
\DoxyCodeLine{245   \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{246 }
\DoxyCodeLine{248   Eigen::VectorXd \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid_a435d10bf8202bacf9cb472b0ac2c0c36}{eigen\_values}};}
\DoxyCodeLine{249 }
\DoxyCodeLine{257   \textcolor{keywordtype}{double} \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid_abc54d1240b184a6dc0eaf16bf6461fbe}{measure}}\{ 0 \};}
\DoxyCodeLine{258 }
\DoxyCodeLine{264   \textcolor{keywordtype}{double} \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid_a85fa8d934966c5522aad3d405fb1296b}{condition}}\{ 0 \};}
\DoxyCodeLine{265 }
\DoxyCodeLine{267   \textcolor{keywordtype}{double} \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid_a3fb9e5490649a2f08866ddf2135e6662}{volume}}\{ 0 \};}
\DoxyCodeLine{268 \};}
\DoxyCodeLine{269 }
\DoxyCodeLine{271 \textcolor{keyword}{struct }\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability}{Manipulability}}}
\DoxyCodeLine{272 \{}
\DoxyCodeLine{273   \textcolor{comment}{// LCOV\_EXCL\_START}}
\DoxyCodeLine{274   EIGEN\_MAKE\_ALIGNED\_OPERATOR\_NEW}
\DoxyCodeLine{275   \textcolor{comment}{// LCOV\_EXCL\_STOP}}
\DoxyCodeLine{276 }
\DoxyCodeLine{278   \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a278ada9b636b868767d17de4c696121c}{m}};}
\DoxyCodeLine{279 }
\DoxyCodeLine{281   \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_afc236fe0a63f4050b89d58e6b69b1d81}{m\_linear}};}
\DoxyCodeLine{282 }
\DoxyCodeLine{284   \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_af88c7eaa372421bbfb610ed8acc46b28}{m\_angular}};}
\DoxyCodeLine{285 }
\DoxyCodeLine{287   \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a3043ecfcb291c4dd9c3fde03244dcf5d}{f}};}
\DoxyCodeLine{288 }
\DoxyCodeLine{290   \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a4969a53954a8b868771b281bba59dcc2}{f\_linear}};}
\DoxyCodeLine{291 }
\DoxyCodeLine{293   \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a681c4751a7b40c0953c9420ad834a910}{f\_angular}};}
\DoxyCodeLine{294 \};}
\DoxyCodeLine{295 }
\DoxyCodeLine{301 \textcolor{keyword}{inline} \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability}{Manipulability}} \mbox{\hyperlink{namespacetesseract__kinematics_ad071f516596c9a983b661f60e4511ac3}{calcManipulability}}(\textcolor{keyword}{const} Eigen::Ref<const Eigen::MatrixXd>\& \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}})}
\DoxyCodeLine{302 \{}
\DoxyCodeLine{303   \mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability}{Manipulability}} manip;}
\DoxyCodeLine{304   Eigen::MatrixXd jacob\_linear = \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}.topRows(3);}
\DoxyCodeLine{305   Eigen::MatrixXd jacob\_angular = \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}.bottomRows(3);}
\DoxyCodeLine{306 }
\DoxyCodeLine{307   \textcolor{keyword}{auto} fn = [](\textcolor{keyword}{const} Eigen::MatrixXd\& \mbox{\hyperlink{kinematics__core__unit_8cpp_a9d4c159548a3d787ff62c64175409328}{m}}) \{}
\DoxyCodeLine{308     \mbox{\hyperlink{structtesseract__kinematics_1_1ManipulabilityEllipsoid}{ManipulabilityEllipsoid}} \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}};}
\DoxyCodeLine{309     Eigen::SelfAdjointEigenSolver<Eigen::MatrixXd> sm(\mbox{\hyperlink{kinematics__core__unit_8cpp_a9d4c159548a3d787ff62c64175409328}{m}}, Eigen::DecompositionOptions::EigenvaluesOnly);}
\DoxyCodeLine{310     \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values = sm.eigenvalues().real();}
\DoxyCodeLine{311 }
\DoxyCodeLine{312     \textcolor{comment}{// Set eigenvalues near zero to zero. This also implies zero volume}}
\DoxyCodeLine{313     \textcolor{keywordflow}{for} (Eigen::Index i = 0; i < \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values.size(); ++i)}
\DoxyCodeLine{314     \{}
\DoxyCodeLine{315       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacetesseract__common_ac9961ff2a5d322165a817241b7746f64}{tesseract\_common::almostEqualRelativeAndAbs}}(\mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values[i], 0))}
\DoxyCodeLine{316         \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values[i] = +0;}
\DoxyCodeLine{317     \}}
\DoxyCodeLine{318 }
\DoxyCodeLine{319     \textcolor{comment}{// If the minimum eigen value is approximately zero set measure and condition to max double}}
\DoxyCodeLine{320     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacetesseract__common_ac9961ff2a5d322165a817241b7746f64}{tesseract\_common::almostEqualRelativeAndAbs}}(\mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values.minCoeff(), 0))}
\DoxyCodeLine{321     \{}
\DoxyCodeLine{322       \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.measure = std::numeric\_limits<double>::max();}
\DoxyCodeLine{323       \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.condition = std::numeric\_limits<double>::max();}
\DoxyCodeLine{324     \}}
\DoxyCodeLine{325     \textcolor{keywordflow}{else}}
\DoxyCodeLine{326     \{}
\DoxyCodeLine{327       \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.condition = \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values.maxCoeff() / \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values.minCoeff();}
\DoxyCodeLine{328       \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.measure = std::sqrt(\mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.condition);}
\DoxyCodeLine{329     \}}
\DoxyCodeLine{330 }
\DoxyCodeLine{331     \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.volume = std::sqrt(\mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}}.eigen\_values.prod());}
\DoxyCodeLine{332 }
\DoxyCodeLine{333     \textcolor{keywordflow}{return} \mbox{\hyperlink{collision__margin__data__unit_8cpp_a0992235f6cab11fba6116193c7f42b8b}{data}};}
\DoxyCodeLine{334   \};}
\DoxyCodeLine{335 }
\DoxyCodeLine{336   Eigen::MatrixXd a = \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}} * \mbox{\hyperlink{kinematics__core__unit_8cpp_afd43241933d01af91643a779b829d7a7}{jacobian}}.transpose();}
\DoxyCodeLine{337   Eigen::MatrixXd a\_linear = jacob\_linear * jacob\_linear.transpose();}
\DoxyCodeLine{338   Eigen::MatrixXd a\_angular = jacob\_angular * jacob\_angular.transpose();}
\DoxyCodeLine{339   manip.\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a278ada9b636b868767d17de4c696121c}{m}} = fn(a);}
\DoxyCodeLine{340   manip.\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_afc236fe0a63f4050b89d58e6b69b1d81}{m\_linear}} = fn(a\_linear);}
\DoxyCodeLine{341   manip.\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_af88c7eaa372421bbfb610ed8acc46b28}{m\_angular}} = fn(a\_angular);}
\DoxyCodeLine{342 }
\DoxyCodeLine{343   Eigen::MatrixXd a\_inv = a.inverse();}
\DoxyCodeLine{344   Eigen::MatrixXd a\_linear\_inv = a\_linear.inverse();}
\DoxyCodeLine{345   Eigen::MatrixXd a\_angular\_inv = a\_angular.inverse();}
\DoxyCodeLine{346   manip.\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a3043ecfcb291c4dd9c3fde03244dcf5d}{f}} = fn(a\_inv);}
\DoxyCodeLine{347   manip.\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a4969a53954a8b868771b281bba59dcc2}{f\_linear}} = fn(a\_linear\_inv);}
\DoxyCodeLine{348   manip.\mbox{\hyperlink{structtesseract__kinematics_1_1Manipulability_a681c4751a7b40c0953c9420ad834a910}{f\_angular}} = fn(a\_angular\_inv);}
\DoxyCodeLine{349 }
\DoxyCodeLine{350   \textcolor{keywordflow}{return} manip;}
\DoxyCodeLine{351 \}}
\DoxyCodeLine{352 }
\DoxyCodeLine{357 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FloatType>}
\DoxyCodeLine{358 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacetesseract__kinematics_a116ec2446a1d878c4be27231149a9896}{getRedundantSolutionsHelper}}(std::vector<\mbox{\hyperlink{namespacetesseract__kinematics_a59d7ac70f855c7d00848b703e6bcfe9a}{VectorX<FloatType>}}>\& redundant\_sols,}
\DoxyCodeLine{359                                         \textcolor{keyword}{const} Eigen::Ref<const Eigen::VectorXd>\& sol,}
\DoxyCodeLine{360                                         \textcolor{keyword}{const} Eigen::MatrixX2d\& \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}},}
\DoxyCodeLine{361                                         std::vector<Eigen::Index>::const\_iterator current\_index,}
\DoxyCodeLine{362                                         std::vector<Eigen::Index>::const\_iterator end\_index)}
\DoxyCodeLine{363 \{}
\DoxyCodeLine{364   \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{365   \textcolor{keywordflow}{for} (; current\_index != end\_index; ++current\_index)}
\DoxyCodeLine{366   \{}
\DoxyCodeLine{367     \textcolor{keywordflow}{if} (std::isinf(\mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 0)))}
\DoxyCodeLine{368     \{}
\DoxyCodeLine{369       std::stringstream ss;}
\DoxyCodeLine{370       ss << \textcolor{stringliteral}{"{}Lower limit of joint "{}} << *current\_index << \textcolor{stringliteral}{"{} is infinite; no redundant solutions will be generated"{}}}
\DoxyCodeLine{371          << std::endl;}
\DoxyCodeLine{372       CONSOLE\_BRIDGE\_logWarn(ss.str().c\_str());}
\DoxyCodeLine{373     \}}
\DoxyCodeLine{374     \textcolor{keywordflow}{else}}
\DoxyCodeLine{375     \{}
\DoxyCodeLine{376       val = sol[*current\_index];}
\DoxyCodeLine{377       \textcolor{keywordflow}{while} ((val -\/= (2.0 * M\_PI)) > \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 0) ||}
\DoxyCodeLine{378              \mbox{\hyperlink{namespacetesseract__common_ac9961ff2a5d322165a817241b7746f64}{tesseract\_common::almostEqualRelativeAndAbs}}(val, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 0)))}
\DoxyCodeLine{379       \{}
\DoxyCodeLine{380         \textcolor{comment}{// It not guaranteed that the provided solution is within limits so this check is needed}}
\DoxyCodeLine{381         \textcolor{keywordflow}{if} (val < \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 1) ||}
\DoxyCodeLine{382             \mbox{\hyperlink{namespacetesseract__common_ac9961ff2a5d322165a817241b7746f64}{tesseract\_common::almostEqualRelativeAndAbs}}(val, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 1)))}
\DoxyCodeLine{383         \{}
\DoxyCodeLine{384           Eigen::VectorXd new\_sol = sol;}
\DoxyCodeLine{385           new\_sol[*current\_index] = val;}
\DoxyCodeLine{386 }
\DoxyCodeLine{387           \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacetesseract__common_a2357c2476cbb1427a259d1dc1b8c20b6}{tesseract\_common::satisfiesPositionLimits<double>}}(new\_sol, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}))}
\DoxyCodeLine{388           \{}
\DoxyCodeLine{389             \mbox{\hyperlink{namespacetesseract__common_a1f8d20fecfeb1e99cc55d316977c3f3d}{tesseract\_common::enforcePositionLimits<double>}}(new\_sol, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}});}
\DoxyCodeLine{390             redundant\_sols.push\_back(new\_sol.template cast<FloatType>());}
\DoxyCodeLine{391           \}}
\DoxyCodeLine{392 }
\DoxyCodeLine{393           getRedundantSolutionsHelper<FloatType>(redundant\_sols, new\_sol, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}, current\_index + 1, end\_index);}
\DoxyCodeLine{394         \}}
\DoxyCodeLine{395       \}}
\DoxyCodeLine{396     \}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398     \textcolor{keywordflow}{if} (std::isinf(\mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 1)))}
\DoxyCodeLine{399     \{}
\DoxyCodeLine{400       std::stringstream ss;}
\DoxyCodeLine{401       ss << \textcolor{stringliteral}{"{}Upper limit of joint "{}} << *current\_index << \textcolor{stringliteral}{"{} is infinite; no redundant solutions will be generated"{}}}
\DoxyCodeLine{402          << std::endl;}
\DoxyCodeLine{403       CONSOLE\_BRIDGE\_logWarn(ss.str().c\_str());}
\DoxyCodeLine{404     \}}
\DoxyCodeLine{405     \textcolor{keywordflow}{else}}
\DoxyCodeLine{406     \{}
\DoxyCodeLine{407       val = sol[*current\_index];}
\DoxyCodeLine{408       \textcolor{keywordflow}{while} ((val += (2.0 * M\_PI)) < \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 1) ||}
\DoxyCodeLine{409              \mbox{\hyperlink{namespacetesseract__common_ac9961ff2a5d322165a817241b7746f64}{tesseract\_common::almostEqualRelativeAndAbs}}(val, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 1)))}
\DoxyCodeLine{410       \{}
\DoxyCodeLine{411         \textcolor{comment}{// It not guaranteed that the provided solution is within limits so this check is needed}}
\DoxyCodeLine{412         \textcolor{keywordflow}{if} (val > \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 0) ||}
\DoxyCodeLine{413             \mbox{\hyperlink{namespacetesseract__common_ac9961ff2a5d322165a817241b7746f64}{tesseract\_common::almostEqualRelativeAndAbs}}(val, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}(*current\_index, 0)))}
\DoxyCodeLine{414         \{}
\DoxyCodeLine{415           Eigen::VectorXd new\_sol = sol;}
\DoxyCodeLine{416           new\_sol[*current\_index] = val;}
\DoxyCodeLine{417 }
\DoxyCodeLine{418           \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacetesseract__common_a2357c2476cbb1427a259d1dc1b8c20b6}{tesseract\_common::satisfiesPositionLimits<double>}}(new\_sol, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}))}
\DoxyCodeLine{419           \{}
\DoxyCodeLine{420             \mbox{\hyperlink{namespacetesseract__common_a1f8d20fecfeb1e99cc55d316977c3f3d}{tesseract\_common::enforcePositionLimits<double>}}(new\_sol, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}});}
\DoxyCodeLine{421             redundant\_sols.push\_back(new\_sol.template cast<FloatType>());}
\DoxyCodeLine{422           \}}
\DoxyCodeLine{423 }
\DoxyCodeLine{424           getRedundantSolutionsHelper<FloatType>(redundant\_sols, new\_sol, \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}}, current\_index + 1, end\_index);}
\DoxyCodeLine{425         \}}
\DoxyCodeLine{426       \}}
\DoxyCodeLine{427     \}}
\DoxyCodeLine{428   \}}
\DoxyCodeLine{429 \}}
\DoxyCodeLine{430 }
\DoxyCodeLine{438 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FloatType>}
\DoxyCodeLine{439 \textcolor{keyword}{inline} std::vector<VectorX<FloatType>> \mbox{\hyperlink{namespacetesseract__kinematics_a325b511b4f36172c8814db524742aed9}{getRedundantSolutions}}(\textcolor{keyword}{const} Eigen::Ref<\textcolor{keyword}{const} \mbox{\hyperlink{namespacetesseract__kinematics_a59d7ac70f855c7d00848b703e6bcfe9a}{VectorX<FloatType>}}>\& sol,}
\DoxyCodeLine{440                                                              \textcolor{keyword}{const} Eigen::MatrixX2d\& \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}},}
\DoxyCodeLine{441                                                              \textcolor{keyword}{const} std::vector<Eigen::Index>\& redundancy\_capable\_joints)}
\DoxyCodeLine{442 \{}
\DoxyCodeLine{443   \textcolor{keywordflow}{if} (redundancy\_capable\_joints.empty())}
\DoxyCodeLine{444     \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{445 }
\DoxyCodeLine{446   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} Eigen::Index\& idx : redundancy\_capable\_joints)}
\DoxyCodeLine{447   \{}
\DoxyCodeLine{448     \textcolor{keywordflow}{if} (idx >= sol.size())}
\DoxyCodeLine{449     \{}
\DoxyCodeLine{450       std::stringstream ss;}
\DoxyCodeLine{451       ss << \textcolor{stringliteral}{"{}Redundant joint index "{}} << idx << \textcolor{stringliteral}{"{} is greater than or equal to the joint state size ("{}} << sol.size()}
\DoxyCodeLine{452          << \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{453       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{454     \}}
\DoxyCodeLine{455   \}}
\DoxyCodeLine{456 }
\DoxyCodeLine{457   std::vector<VectorX<FloatType>> redundant\_sols;}
\DoxyCodeLine{458   getRedundantSolutionsHelper<FloatType>(redundant\_sols,}
\DoxyCodeLine{459                                          sol.template cast<double>(),}
\DoxyCodeLine{460                                          \mbox{\hyperlink{tesseract__scene__graph__joint__unit_8cpp_a0be90f4a70bf84d8470599423bd3157b}{limits}},}
\DoxyCodeLine{461                                          redundancy\_capable\_joints.begin(),}
\DoxyCodeLine{462                                          redundancy\_capable\_joints.end());}
\DoxyCodeLine{463   \textcolor{keywordflow}{return} redundant\_sols;}
\DoxyCodeLine{464 \}}
\DoxyCodeLine{465 }
\DoxyCodeLine{475 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FloatType>}
\DoxyCodeLine{476 \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacetesseract__kinematics_a2f74af65eeb166856e00a64254da7ee8}{isValid}}(\textcolor{keyword}{const} std::array<FloatType, 6>\& qs)}
\DoxyCodeLine{477 \{}
\DoxyCodeLine{478   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& \mbox{\hyperlink{kinematics__core__unit_8cpp_af1c133f4166e08b7a95ddebfeef08de9}{q}} : qs)}
\DoxyCodeLine{479     \textcolor{keywordflow}{if} (!std::isfinite(\mbox{\hyperlink{kinematics__core__unit_8cpp_af1c133f4166e08b7a95ddebfeef08de9}{q}}))}
\DoxyCodeLine{480       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{481 }
\DoxyCodeLine{482   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{483 \}}
\DoxyCodeLine{484 }
\DoxyCodeLine{490 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FloatType>}
\DoxyCodeLine{491 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacetesseract__kinematics_a51971caada7d5330a60765fd1a83cda1}{harmonizeTowardZero}}(Eigen::Ref<\mbox{\hyperlink{namespacetesseract__kinematics_a59d7ac70f855c7d00848b703e6bcfe9a}{VectorX<FloatType>}}> qs,}
\DoxyCodeLine{492                                 \textcolor{keyword}{const} std::vector<Eigen::Index>\& redundancy\_capable\_joints)}
\DoxyCodeLine{493 \{}
\DoxyCodeLine{494   \textcolor{keyword}{const} \textcolor{keyword}{static} \textcolor{keyword}{auto} \mbox{\hyperlink{contact__managers__factory__unit_8cpp_ae40c83f984192e54ccc972b090e8f401}{pi}} = FloatType(M\_PI);}
\DoxyCodeLine{495   \textcolor{keyword}{const} \textcolor{keyword}{static} \textcolor{keyword}{auto} two\_pi = FloatType(2.0 * M\_PI);}
\DoxyCodeLine{496 }
\DoxyCodeLine{497   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& i : redundancy\_capable\_joints)}
\DoxyCodeLine{498   \{}
\DoxyCodeLine{499     FloatType diff = std::fmod(qs[i] + \mbox{\hyperlink{contact__managers__factory__unit_8cpp_ae40c83f984192e54ccc972b090e8f401}{pi}}, two\_pi);}
\DoxyCodeLine{500     qs[i] = (diff < 0) ? (diff + \mbox{\hyperlink{contact__managers__factory__unit_8cpp_ae40c83f984192e54ccc972b090e8f401}{pi}}) : (diff -\/ \mbox{\hyperlink{contact__managers__factory__unit_8cpp_ae40c83f984192e54ccc972b090e8f401}{pi}});}
\DoxyCodeLine{501   \}}
\DoxyCodeLine{502 \}}
\DoxyCodeLine{503 }
\DoxyCodeLine{504 \}  \textcolor{comment}{// namespace tesseract\_kinematics}}
\DoxyCodeLine{505 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// TESSERACT\_KINEMATICS\_UTILS\_H}}

\end{DoxyCode}
